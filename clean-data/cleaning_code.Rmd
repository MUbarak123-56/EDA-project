---
title: "data cleaning"
output: html_document
---


import data
```{r}
library(readr)
library(janitor)
music <- read_csv("~/Documents/EDA/tcc_ceds_music.csv")%>%
  clean_names()
View(music)
```

checking assertions
```{r}
library(tidyverse)
library(assertr)
library(corrplot)

#initial exploration of variables
class(music)

music%>%
  summarise(min(release_date), max(release_date))

#check that values are between 0-1 for acousticness, instrumentalness, valence, energy, and age
music%>%
  assert(within_bounds(0,1), acousticness:energy)%>%
  assert(within_bounds(0,1), age)

#check for NAs
music%>%
  assert(not_na, artist_name:age)

```


```{r}
music = na.omit(music)
#Min-Max Scaling 
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}

Length_norm=normalize(music$len)

music<- music %>%
  mutate(Length_norm)
```


remove unwanted variables after checking correlations
```{r}
music <- music %>%
  select(-x1)
music <- music %>% 
  mutate(id = 1) %>% 
  mutate(id = cumsum(id))
head(music)

new_t <- music %>% 
  select(dating:energy)
colnames(new_t)

new_t$valence = as.numeric(new_t$valence)
new_t$energy = as.numeric(new_t$energy)

# delete NAs

new_t = na.omit(new_t)

# scatterplot matrix of the audio feature parameters
corrplot(cor(new_t))
```




